<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Student Dashboard</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Student dashboard for managing profile, messages, sessions, and more." />
  <style>
    /* Logout Confirm Modal */
    .modal {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }
    .modal-content {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      text-align: center;
      width: 90%;
      max-width: 400px;
    }
    .modal-buttons {
      margin-top: 1.5rem;
      display: flex;
      justify-content: space-around;
    }
    .btn-confirm {
      background-color: #f57c00;
      color: white;
      padding: 0.7rem 1.5rem;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
    }
    .btn-cancel {
      background-color: #ccc;
      color: black;
      padding: 0.7rem 1.5rem;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
    }
    .hidden { display: none; }
    .visible { display: block; }
  </style>
</head>

<body class="dashboard">

  <!-- Glowing effect -->
  <div class="glow-circle"></div>
  <div class="glow-circle delay-1"></div>
  <div class="glow-circle delay-2"></div>

  <!-- Top navigation -->
  <div class="top-bar">
    <div>
      <a href="homepage-student.html" style="color: white;">‚Üê Home</a>
    </div>
    <div class="top-links">
<<<<<<< HEAD
<<<<<<< HEAD
      <span id="welcome-student" style="margin-right: 15px;"></span>
=======
      <a href="student-myprofile.html" style="color: white;">My Profile</a>
>>>>>>> b6462d2 (public/student-myprofile.html)
=======
      <span id="welcome-student" style="margin-right: 15px;"></span>
>>>>>>> 228c8c7 (public/homepage-student.html)
      <button class="logout-btn" onclick="showLogoutModal('student')" style="background:none; border:none; color:white; font-weight:bold; cursor:pointer;">Logout</button>
      <a href="student-schedule.html" style="color: white; text-decoration: none;">üìÖ</a>
      <span>‚öôÔ∏è</span>
      <span class="notification-icon" onclick="toggleNotifications()">üîî</span>
    </div>
  </div>

  <!-- Notification Dropdown -->
  <div id="notification-dropdown" class="notification-dropdown hidden">
    <p>No new notifications</p>
  </div>

  <!-- Dashboard Title -->
  <h1 style="color: white;">Student Dashboard</h1>

  <!-- Dashboard Grid -->
  <div class="grid">
    <a href="student-tutors.html" class="grid-item">
      <img src="https://img.icons8.com/ios-filled/100/group-background-selected.png" alt="Tutors" />
      <p>My Tutors</p>
    </a>
    <a href="chat.html" class="grid-item">
      <img src="https://img.icons8.com/ios-filled/100/message-squared.png" alt="Messages" />
      <p>Messages</p>
    </a>
    <a href="student-subjects.html" class="grid-item">
      <img src="https://img.icons8.com/ios-filled/100/book.png" alt="Subjects" />
      <p>Subjects</p>
    </a>
    <a href="student-session-history.html" class="grid-item">
      <img src="https://img.icons8.com/ios-filled/100/clock--v1.png" alt="Session History" />
      <p>Session History</p>
    </a>
    <a href="student-schedule.html" class="grid-item">
      <img src="https://img.icons8.com/ios-filled/100/planner.png" alt="Schedule" />
      <p>My Schedule</p>
    </a>
  </div>

  <!-- Confirm Logout Modal -->
  <div id="confirmLogoutModal" class="modal hidden">
    <div class="modal-content">
      <h3>Are you sure you want to logout?</h3>
      <div class="modal-buttons">
        <button id="confirmLogoutYes" class="btn-confirm">Yes, Logout</button>
        <button id="confirmLogoutNo" class="btn-cancel">No, Stay</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/logout.js"></script>

  <script>
    // ‚ú® Show student's name (cosmetic only)
    const studentName = localStorage.getItem("userName") || "Student";
    document.getElementById("welcome-student").textContent = `Welcome, ${studentName}!`;

    // Notification logic
    const notificationDropdown = document.getElementById("notification-dropdown");

    const toggleNotifications = () => {
      notificationDropdown.classList.toggle("visible");
    };

    const addNotification = (message) => {
      const notificationItem = document.createElement("div");
      notificationItem.className = "notification-item";
      notificationItem.textContent = message;
      notificationDropdown.appendChild(notificationItem);
    };

    const fetchNotifications = async () => {
      const studentName = localStorage.getItem("userName");
      try {
        const res = await fetch(`http://localhost:5000/api/appointment/upcoming-student?studentName=${encodeURIComponent(studentName)}`);
        const data = await res.json();
        if (!res.ok) throw new Error(data.message);

        notificationDropdown.innerHTML = "";

        if (data.length === 0) {
          notificationDropdown.innerHTML = "<p>No upcoming appointments</p>";
          return;
        }

        data.forEach((appointment) => {
          addNotification(`Upcoming session with ${appointment.tutorName} on ${appointment.date} at ${appointment.time}`);
        });
      } catch (err) {
        notificationDropdown.innerHTML = "<p>Failed to load notifications</p>";
      }
    };

    fetchNotifications();

    // ‚úÖ Confirm Logout Modal Logic
    function showLogoutModal(role) {
      const modal = document.getElementById('confirmLogoutModal');
      modal.classList.remove('hidden');

      const yesButton = document.getElementById('confirmLogoutYes');
      const noButton = document.getElementById('confirmLogoutNo');

      yesButton.onclick = () => {
        if (role === 'student') {
          logoutUser(); // from your js/logout.js
        }
      };

      noButton.onclick = () => {
        modal.classList.add('hidden');
      };
    }
  </script>

</body>
</html>

